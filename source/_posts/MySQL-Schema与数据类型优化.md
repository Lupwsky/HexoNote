---
title: MySQL-Schema与数据类型优化
date: 2018-03-24 15:23:41
categories: 高性能MySQL
---

　　良好的数据表设计是高性能的基石，应该根据系统需要执行的查询语句来设计 Schema，这往往需要需要考虑很多的因素，例如使用烦范式设计可以加快某些类型的查询，但同时也会使另一些查询变慢，例如添加计数表和汇总表可以优化查询速度，但是这会增加维护这些表的成本，当然这些都需要根据实际的情况来选择。

<!-- more -->

### 选择优化的数据类型
　　MySQL 支持很多的数据类型，合理的选择数据类型由助于提高性能，以下有几个建议的原则：
+ 更小的数据类型
+ 使用简单的数据类型
+ 尽量避免 NULL

#### 更小的数据类型
　　更小的数据类型占据更小的磁盘、内存和 CPU，但是要确保能够存储之后需要存储的值，否则后续修改会很痛苦，因为对大表修改表结构是很耗时间的操作。

#### 使用简单的数据类型
　　简单的数据类型耗费更少的 CPU 资源，如整型的操作就比字符操作代价更低(字符集的校对规则比整型更加复杂)，例如使用 MySQL 内建的类型存储日期时间而不是使用字符串存储日期时间，使用整型存储 IP 地址而不是使用字符串存储。

#### 尽量避免 NULL
　　可为 NULL 的列使得索引、索引统计和值比较变得更加复杂。可为 NULL 的列使用索引时会使用更多的存储空间，在　MySQL 中需要特殊的处理，每个索引需要一个额外的字节，如果要在某一列上建立索引，尽量设计成　NOT NULL。把可以　NULL 的列变成　NOT NULL 带来的性能提示较小，对于大表如果确定　NULL　值会带来问题才会选择去优化它。
　　例如在　where 子条件查询中对字段进行　NULL 判断(如　where num is null)，会导致引擎放弃索引而进行全表扫描，但是如果将　NULL 判断更改为　where num = 0 引擎则会使用索引进行扫描。

 